import{z as J,o as K,s as z,w as W,a as m,c as b,i as Q,m as Z,b as Y,n as V,d as i,e as P,t as y,f as F,g as x,F as E,r as L,h as ee,j as te,k as D,l as q,p as O,q as k,u as X,v as C,x as N,y as G,A as R,B as oe,C as re}from"./vendor.bb1440c7.js";const ne=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}};ne();const ae=[{name:"Speaker",colour:"#DDDDDD",abbr:["Spk","SPK","Speaker Seeking Re-Election"],fullname:"Speaker"},{name:"Respect Party",colour:"#46801C",abbr:["Respect","RESPECT"],fullname:"Respect Party"},{name:"Democratic Unionist Party",colour:"#D46A4C",abbr:["DUP","dup"],fullname:"Democratic Unionist Party"},{name:"Christian Peoples Alliance",colour:"#813887",abbr:["CPA","cpa"],fullname:"Christian Peoples Alliance"},{name:"National Front",colour:"midnightblue",abbr:["NF","nf"],fullname:"National Front"},{name:"Sinn Fein",colour:"#326760",abbr:["SF","sf"],fullname:"Sinn Fein"},{name:"Ulster Conservatives and Unionists - New Force",colour:"#9999FF",abbr:["UCF-NF"],fullname:"Ulster Conservatives and Unionists - New Force"},{name:"Alliance",colour:"#F6CB2F",abbr:["All","ALL"],fullname:"Alliance"},{name:"Social Democratic & Labour Party",colour:"#3A9E84",abbr:["SDLP"],fullname:"Social Democratic & Labour Party"},{name:"Soc Lab",colour:"#EE1C25",abbr:["Soc Lab"],fullname:"Socialist Labour"},{name:"Lab Co-op",colour:"#DC241f",abbr:["Lab Co-op"],fullname:"Labour Co-operative"},{name:"Monster Raving Loony Party",colour:"#FFF000",abbr:["MRLP"],fullname:"Official Monster Raving Loony Party"},{name:"Trade Unionist and Socialist Coalition",colour:"#EC008C",abbr:["TUSC"],fullname:"Trade Unionist and Socialist Coalition"},{name:"Plaid Cymru",colour:"#008142",abbr:["PC"],fullname:"Plaid Cymru"},{name:"Scottish National Party",colour:"#FDF38E",abbr:["SNP"],fullname:"Scottish National Party"},{name:"Christian Party",colour:"#9966CC",abbr:"Christian",fullname:"Christian Party"},{name:"English Democrats",colour:"#915F6D",abbr:["ED"],fullname:"English Democrats"},{name:"Independent",colour:"#DDDDDD",abbr:["Ind","No Description"],fullname:"Independent"},{name:"Green Party",colour:"#6AB023",abbr:["Green"],fullname:"Green Party"},{name:"British National Party",colour:"#2e3b74",abbr:["BNP"],fullname:"British National Party"},{name:"United Kingdom Independence Party",colour:"#70147A",abbr:["UKIP"],fullname:"UK Independence Party"},{name:"Labour Party",colour:"#DC241f",abbr:["Lab"],fullname:"Labour"},{name:"Conservative Party",colour:"#0087DC",abbr:["Con"],fullname:"Conservative"},{name:"Liberal Democrat",colour:"#FAA61A",abbr:["LD"],fullname:"Liberal Democrat"},{name:"Ulster Unionist Party",colour:"#48A5EE",abbr:["UUP"],fullname:"Ulster Unionist Party"},{name:"Brexit Party",colour:"#12B6CF",abbr:["Brexit","RefUK"],fullname:"Reform UK"}];var I={parties:ae};const A=(r,e,n,a)=>{let o,s,u,f,p,d,_,v=Math.round,g=typeof n=="string";return typeof r!="number"||r<-1||r>1||typeof e!="string"||e[0]!="r"&&e[0]!="#"||n&&!g||(_=e.length>9,_=g?n.length>9?!0:n=="c"?!_:!1:_,p=A.pSBCr(e),f=r<0,d=n&&n!="c"?A.pSBCr(n):f?{r:0,g:0,b:0,a:-1}:{r:255,g:255,b:255,a:-1},r=f?r*-1:r,f=1-r,!p||!d)?null:(a?(o=v(f*p.r+r*d.r),s=v(f*p.g+r*d.g),u=v(f*p.b+r*d.b)):(o=v((f*p.r**2+r*d.r**2)**.5),s=v((f*p.g**2+r*d.g**2)**.5),u=v((f*p.b**2+r*d.b**2)**.5)),g=p.a,d=d.a,p=g>=0||d>=0,g=p?g<0?d:d<0?g:g*f+d*r:0,_?"rgb"+(p?"a(":"(")+o+","+s+","+u+(p?","+v(g*1e3)/1e3:"")+")":"#"+(4294967296+o*16777216+s*65536+u*256+(p?v(g*255):0)).toString(16).slice(1,p?void 0:-2))};A.pSBCr=r=>{const e=parseInt;let n=r.length,a={};if(n>9){const[o,s,u,f]=r=r.split(",");if(n=r.length,n<3||n>4)return null;a.r=e(o[3]=="a"?o.slice(5):o.slice(4)),a.g=e(s),a.b=e(u),a.a=f?parseFloat(f):-1}else{if(n==8||n==6||n<4)return null;n<6&&(r="#"+r[1]+r[1]+r[2]+r[2]+r[3]+r[3]+(n>4?r[4]+r[4]:"")),r=e(r.slice(1),16),n==9||n==5?(a.r=r>>24&255,a.g=r>>16&255,a.b=r>>8&255,a.a=Math.round((r&255)/.255)/1e3):(a.r=r>>16,a.g=r>>8&255,a.b=r&255,a.a=-1)}return a};const le={class:"w-full h-full rounded-lg shadow-lg bg-slate-600"},se={props:{boundary:Object,election:Object,displayType:Object,tagProperty:String},emits:["changeFocus"],setup(r,{emit:e}){const n=r,a=600,o=700,s=J();var u,f,p=null,d=!1;function _(l){if(l==null)return"#616161";for(let c of I.parties)if(c.name==l||c.fullname==l||c.abbr.includes(l)||c.abbr.includes(l.toLowerCase()))return c.colour;return"#616161"}function v(l){if(console.log("boundary",l),l==null||l=={}||l.features==null||l.features.length==0)return;let c=Q().projection(Z().fitExtent([[0,0],[o,a]],l));u.attr("viewBox",[[0,0],[o,a]]),u.call(s.on("zoom",t=>{f.attr("transform",t.transform)}).scaleExtent([1,8]).translateExtent([[0,0],[o,a]])),f.attr("transform","translate(0 0) scale(1)"),f.selectAll("path").data(l.features).enter().append("path").attr("d",c).attr("data-tag",t=>t.properties[n.tagProperty]).attr("fill","red").on("mouseover",t=>{d||e("changeFocus",t.target.getAttribute("data-tag"))}).on("click",t=>{let h=t.target.getBBox(),[w,H]=[h.x+h.width/2,h.y+h.height/2];if(p&&(p.setAttribute("stroke",""),p.getAttribute("data-tag")==t.target.getAttribute("data-tag"))){u.transition().duration(500).call(s.transform,Y),d=!1,p=null;return}u.transition().duration(500).call(s.transform,Y.translate(o/2,a/2).scale(8).translate(-w,-H)),t.target.setAttribute("stroke","gold"),t.target.setAttribute("stroke-width","0.05%"),t.target.setAttribute("stroke-linejoin","round"),z(t.target).raise(),d=!0,p=t.target,e("changeFocus",t.target.getAttribute("data-tag"))})}function g(l,c){f.selectAll("path").attr("fill",t=>{let h;switch(n.displayType.filter){case"majority":h=$;break;case"plurality":h=j;break;default:h=B}if(!h(l,t))return"#616161";switch(n.displayType.fill){case"majority":return T(l,t);case"second":return M(l,t);case"turnout":return S(l,t);default:return U(l,t)}})}function $(l,c){let t=l[c.properties[n.tagProperty]];return!t||!t.candidates[0]||t.turnout<=0?!1:t.candidates[0].votes/t.turnout>.5}function j(l,c){return!$(l,c)}function B(){return!0}function U(l,c){var h;let t=((h=l[c.properties[n.tagProperty]])==null?void 0:h.mp.party)||void 0;return _(t)}function M(l,c){var h,w;let t=((w=(h=l[c.properties[n.tagProperty]])==null?void 0:h.candidates[1])==null?void 0:w.party)||void 0;return _(t)}function S(l,c){let t=.5,h=l[c.properties[n.tagProperty]];return h?A((1-t-h.turnout/h.electorate)*1.5,"#aed581",!1,!0):"#616161"}function T(l,c){var w;let t=l[c.properties[n.tagProperty]];if(!t)return"#616161";let h=((w=l[c.properties[n.tagProperty]])==null?void 0:w.mp.party)||void 0;return A(1-t.majority/t.candidates[0].votes-.25,_(h),!1,!0)}return K(async()=>{u=z("div svg").attr("viewBox",[[0,0],[o,a]]),f=u.append("g"),W(()=>{v(n.boundary.value)}),W(()=>{console.log("recolouring map"),g(n.election.value)})}),(l,c)=>(m(),b("div",le,[(m(),b("svg",{ref_key:"map",ref:u,class:"rounded-lg"},null,512))]))}},ie={props:{width:String,colour:String},setup(r){const e=r;return(n,a)=>(m(),b("div",{style:V("width: "+e.width+"; background-color: "+e.colour),class:"h-5 my-1 transition-all duration-500 ease-in float-left relative"},null,4))}},ce={class:"flex items-center rounded-xl bg-slate-800 bg-opacity-50 my-2 px-2 py-1"},ue={class:"basis-2/6"},de=P(") "),fe={class:"basis-2/6"},pe={class:"basis-2/6"},me={class:"float-right"},be={props:{candidate:Object,totalVotes:Number},setup(r){const e=r;function n(a){for(let o of I.parties)if(o.name==a||o.fullname==a||o.abbr.includes(a)||o.abbr.includes(a.toLowerCase()))return o.colour;return"#DDDDDD"}return(a,o)=>(m(),b("div",ce,[i("span",ue,[P(y(e.candidate.candidate)+" (",1),i("span",{class:"font-bold",style:V("color: "+n(e.candidate.party))},y(e.candidate.party),5),de]),i("span",fe,y(e.candidate.votes)+" ("+y(Math.floor(e.candidate.votes/e.totalVotes*100*100)/100)+"%) ",1),i("div",pe,[F(ie,{width:`${100*e.candidate.votes/e.totalVotes}%`,colour:n(e.candidate.party)},null,8,["width","colour"]),i("span",me,y(e.candidate.change),1)])]))}},ye={class:"w-full bg-slate-600 rounded-lg shadow-lg p-4 text-gray-100"},he={key:0,class:"block font-bold text-2xl"},_e={key:1,class:"inline-block font-bold text-3xl"},ge={key:2,class:"inline-block font-thin text-sm pl-2"},ve={key:3,class:"block font-bold text-xl"},Pe=P(" By-Election: "),xe={class:"font-normal"},Ce=i("br",null,null,-1),we=P(" Date: "),De={class:"font-normal"},ke=i("br",null,null,-1),Se=P(" Reason: "),Ee={class:"font-normal"},je={key:4,class:"block font-bold text-xl"},Be=P(") "),Fe={key:5,class:"font-bold text-lg inline-block"},Le=P(" Result: "),Ae={class:"font-normal"},$e=P(" majority of "),Ue={class:"font-normal"},Me={key:6,class:"font-bold text-lg block"},Oe=P(" Electorate: "),Ne={class:"font-normal"},Re=P(" turnout of "),Te={class:"font-normal"},Ve={key:7},Ge={key:0},Ie={props:{result:Object},setup(r){const e=r;function n(o){let s=5,u=0,f=[],p=[],d=0;for(let _ of o)u<s||u==s&&u==o.length-1?(_.order=u,f.push(_)):(d+=_.votes,p.push(_.party)),u++;return d!=0&&f.push({candidate:"Other",party:"Various",votes:d}),[f,p]}function a(o){for(let s of I.parties)if(s.name==o||s.fullname==o||s.abbr.includes(o)||s.abbr.includes(o.toLowerCase()))return s.colour;return"#DDDDDD"}return(o,s)=>(m(),b("div",ye,[e.result.name?x("",!0):(m(),b("h1",he,"Select or Mouseover A Constituency To Begin")),e.result.name?(m(),b("h1",_e,y(e.result.name||""),1)):x("",!0),e.result.id?(m(),b("h5",ge,"("+y(e.result.id||"")+")",1)):x("",!0),e.result["by-election"]?(m(),b("h3",ve,[Pe,i("span",xe,y(e.result["by-election"].previous),1),Ce,we,i("span",De,y(e.result["by-election"].date),1),ke,Se,i("span",Ee,y(e.result["by-election"].reason),1)])):x("",!0),e.result.mp?(m(),b("h3",je,[P(" Elected MP: "+y(e.result.mp.name||"N/A")+" (",1),i("span",{style:V("color: "+a(e.result.mp.party))},y(e.result.mp.party||"Ind"),5),Be])):x("",!0),e.result.result&&e.result.majority&&e.result.electorate?(m(),b("h3",Fe,[Le,i("span",Ae,y(e.result.result),1),$e,i("span",Ue,y(e.result.majority)+" ("+y(Math.floor(e.result.majority/e.result.electorate*100*100)/100)+"%)",1)])):x("",!0),e.result.electorate&&e.result.turnout?(m(),b("h3",Me,[Oe,i("span",Ne,y(e.result.electorate),1),Re,i("span",Te,y(e.result.turnout)+" ("+y(Math.floor(e.result.turnout/e.result.electorate*100*100)/100)+"%)",1)])):x("",!0),e.result.candidates?(m(),b("div",Ve,[(m(!0),b(E,null,L(n(e.result.candidates)[0],u=>(m(),ee(be,{key:u.order,candidate:u,totalVotes:e.result.turnout},null,8,["candidate","totalVotes"]))),128)),n(e.result.candidates)[1].length>0?(m(),b("span",Ge," Others: "+y(n(e.result.candidates)[1].join(", "))+". ",1)):x("",!0)])):x("",!0)]))}};var Ke=(r,e)=>{const n=r.__vccOpts||r;for(const[a,o]of e)n[a]=o;return n};const ze={},We={href:"https://github.com/jamesm2w",class:"",target:"_blank"},Ye=i("div",{class:"m-4 mb-0 p-2 text-gradient text-transparent bg-clip-text w-min pointer-events-none select-none"},[i("h3",{class:"font-mono font-bold text-3xl"},"jamesm2w/"),i("h1",{class:"font-mono font-semibold text-5xl"},[P(" Election "),i("br"),P("Results ")])],-1),qe=[Ye];function Xe(r,e){return m(),b("a",We,qe)}var He=Ke(ze,[["render",Xe]]);const Je={id:"selectionList"},Qe=["value"],Ze={props:{election:Object},setup(r){const e=r;return te(e.election,()=>{console.log("election",e.election.value)}),(n,a)=>(m(),b("datalist",Je,[(m(!0),b(E,null,L(Object.keys(e.election.value),o=>(m(),b("option",{key:o,value:e.election.value[o].id},y(e.election.value[o].name),9,Qe))),128))]))}},et={class:"flex justify-between items-center flex-wrap"},tt={class:"mr-4 my-2 bg-slate-400 p-4 rounded-md shadow-md flex flex-wrap items-center justify-between space-x-2 w-8/12"},ot=i("label",{for:"selectElectionCode"},"Election: ",-1),rt=i("label",{for:"selectMapShading"},"Display: ",-1),nt=["value"],at=i("label",{for:"selectMapFilter"},"Filter: ",-1),lt=["value"],st={class:"basis-full place-self-start"},it={setup(r){let e=D({value:{}}),n=D({value:{}}),a=D({value:{}}),o=D({value:{}}),s=D({value:{}}),u=D({value:{}}),f=D({value:{}}),p=q({focusOn:""}),d=O("GE2019"),_=O("winner"),v=O("all"),g=O(""),$=q({fill:_,filter:v});const j={Default:"winner","Runner-Up":"second","Majority Shaded":"majority","Turnout Shaded":"turnout"},B={All:"all","Won on Majority":"majority","Won on Plurality":"plurality"},U={"BYE 2019-202X":{election:a,boundary:e},GE2019:{election:n,boundary:e},"BYE 2017-2015":{election:u,boundary:e},GE2017:{election:o,boundary:e},"BYE 2015-2017":{election:f,boundary:e},GE2015:{election:s,boundary:e}};function M(l){p.focusOn=l}K(async()=>{e.value=await k("./WestminsterConst.geojson"),n.value=await k("./2019.json"),o.value=await k("./2017.json"),s.value=await k("./2015.json"),a.value=await k("./2019-_ByElections.json"),u.value=await k("./2017-2019_ByElections.json"),f.value=await k("./2015-2017_ByElections.json")});const S=X(()=>U[d.value]),T=X(()=>S.value.election.value[p.focusOn]||{});return(l,c)=>(m(),b(E,null,[i("div",null,[i("div",et,[F(He),i("div",tt,[F(Ze,{election:C(S).election},null,8,["election"]),i("div",null,[ot,N(i("select",{name:"selectElectionCode",class:"cursor-pointer","onUpdate:modelValue":c[0]||(c[0]=t=>R(d)?d.value=t:d=t)},[(m(!0),b(E,null,L(Object.keys(U),t=>(m(),b("option",{key:t},y(t),1))),128))],512),[[G,C(d)]])]),i("div",null,[rt,N(i("select",{name:"selectMapShading",class:"cursor-pointer","onUpdate:modelValue":c[1]||(c[1]=t=>R(_)?_.value=t:_=t),value:"winner"},[(m(!0),b(E,null,L(Object.keys(j),t=>(m(),b("option",{key:j[t],value:j[t]},y(t),9,nt))),128))],512),[[G,C(_)]])]),i("div",null,[at,N(i("select",{name:"selectMapFilter",class:"cursor-pointer","onUpdate:modelValue":c[2]||(c[2]=t=>R(v)?v.value=t:v=t),value:"all"},[(m(!0),b(E,null,L(Object.keys(B),t=>(m(),b("option",{key:B[t],value:B[t]},y(t),9,lt))),128))],512),[[G,C(v)]])]),i("div",st,[N(i("input",{id:"selectConstituency",ref:"selectConst","onUpdate:modelValue":c[3]||(c[3]=t=>R(g)?g.value=t:g=t),placeholder:"Select Constituency",list:"selectionList"},null,512),[[oe,C(g)]]),i("button",{id:"selectConstituencyButton",onClick:c[4]||(c[4]=t=>M(l.$refs.selectConst.value))},"Select")])])]),F(Ie,{result:C(T)},null,8,["result"])]),F(se,{boundary:C(S).boundary,election:C(S).election,tagProperty:"PCON20CD",displayType:C($),onChangeFocus:M},null,8,["boundary","election","displayType"])],64))}};re(it).mount("#app");
