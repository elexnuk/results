import{z as Z,o as q,s as Y,w as X,a as H,b as p,c as h,i as ee,m as te,d as J,n as V,e as i,f as P,t as b,g as B,h as S,F as j,r as A,j as ne,k,l as G,p as I,q as C,u as Q,v as x,x as M,y as oe,A as K,B as z,C as re,D as ae}from"./vendor.bb148c0f.js";const le=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerpolicy&&(l.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?l.credentials="include":n.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}};le();const se=[{name:"Speaker",colour:"#DDDDDD",abbr:["Spk","SPK","Speaker Seeking Re-Election"],fullname:"Speaker"},{name:"Respect Party",colour:"#46801C",abbr:["Respect","RESPECT"],fullname:"Respect Party"},{name:"Democratic Unionist Party",colour:"#D46A4C",abbr:["DUP","dup"],fullname:"Democratic Unionist Party"},{name:"Christian Peoples Alliance",colour:"#813887",abbr:["CPA","cpa"],fullname:"Christian Peoples Alliance"},{name:"National Front",colour:"midnightblue",abbr:["NF","nf"],fullname:"National Front"},{name:"Sinn Fein",colour:"#326760",abbr:["SF","sf"],fullname:"Sinn Fein"},{name:"Ulster Conservatives and Unionists - New Force",colour:"#9999FF",abbr:["UCF-NF"],fullname:"Ulster Conservatives and Unionists - New Force"},{name:"Alliance",colour:"#F6CB2F",abbr:["All","ALL"],fullname:"Alliance"},{name:"Social Democratic & Labour Party",colour:"#3A9E84",abbr:["SDLP"],fullname:"Social Democratic & Labour Party"},{name:"Soc Lab",colour:"#EE1C25",abbr:["Soc Lab"],fullname:"Socialist Labour"},{name:"Lab Co-op",colour:"#DC241f",abbr:["Lab Co-op"],fullname:"Labour Co-operative"},{name:"Monster Raving Loony Party",colour:"#FFF000",abbr:["MRLP"],fullname:"Official Monster Raving Loony Party"},{name:"Trade Unionist and Socialist Coalition",colour:"#EC008C",abbr:["TUSC"],fullname:"Trade Unionist and Socialist Coalition"},{name:"Plaid Cymru",colour:"#008142",abbr:["PC"],fullname:"Plaid Cymru"},{name:"Scottish National Party",colour:"#FDF38E",abbr:["SNP"],fullname:"Scottish National Party"},{name:"Christian Party",colour:"#9966CC",abbr:"Christian",fullname:"Christian Party"},{name:"English Democrats",colour:"#915F6D",abbr:["ED"],fullname:"English Democrats"},{name:"Independent",colour:"#DDDDDD",abbr:["Ind","No Description"],fullname:"Independent"},{name:"Green Party",colour:"#6AB023",abbr:["Green"],fullname:"Green Party"},{name:"British National Party",colour:"#2e3b74",abbr:["BNP"],fullname:"British National Party"},{name:"United Kingdom Independence Party",colour:"#70147A",abbr:["UKIP"],fullname:"UK Independence Party"},{name:"Labour Party",colour:"#DC241f",abbr:["Lab"],fullname:"Labour"},{name:"Conservative Party",colour:"#0087DC",abbr:["Con"],fullname:"Conservative"},{name:"Liberal Democrat",colour:"#FAA61A",abbr:["LD"],fullname:"Liberal Democrat"},{name:"Ulster Unionist Party",colour:"#48A5EE",abbr:["UUP"],fullname:"Ulster Unionist Party"},{name:"Brexit Party",colour:"#12B6CF",abbr:["Brexit","RefUK"],fullname:"Reform UK"}];var W={parties:se};const O=(o,e,r,a)=>{let n,l,u,f,d,m,y,v=Math.round,g=typeof r=="string";return typeof o!="number"||o<-1||o>1||typeof e!="string"||e[0]!="r"&&e[0]!="#"||r&&!g||(y=e.length>9,y=g?r.length>9?!0:r=="c"?!y:!1:y,d=O.pSBCr(e),f=o<0,m=r&&r!="c"?O.pSBCr(r):f?{r:0,g:0,b:0,a:-1}:{r:255,g:255,b:255,a:-1},o=f?o*-1:o,f=1-o,!d||!m)?null:(a?(n=v(f*d.r+o*m.r),l=v(f*d.g+o*m.g),u=v(f*d.b+o*m.b)):(n=v((f*d.r**2+o*m.r**2)**.5),l=v((f*d.g**2+o*m.g**2)**.5),u=v((f*d.b**2+o*m.b**2)**.5)),g=d.a,m=m.a,d=g>=0||m>=0,g=d?g<0?m:m<0?g:g*f+m*o:0,y?"rgb"+(d?"a(":"(")+n+","+l+","+u+(d?","+v(g*1e3)/1e3:"")+")":"#"+(4294967296+n*16777216+l*65536+u*256+(d?v(g*255):0)).toString(16).slice(1,d?void 0:-2))};O.pSBCr=o=>{const e=parseInt;let r=o.length,a={};if(r>9){const[n,l,u,f]=o=o.split(",");if(r=o.length,r<3||r>4)return null;a.r=e(n[3]=="a"?n.slice(5):n.slice(4)),a.g=e(l),a.b=e(u),a.a=f?parseFloat(f):-1}else{if(r==8||r==6||r<4)return null;r<6&&(o="#"+o[1]+o[1]+o[2]+o[2]+o[3]+o[3]+(r>4?o[4]+o[4]:"")),o=e(o.slice(1),16),r==9||r==5?(a.r=o>>24&255,a.g=o>>16&255,a.b=o>>8&255,a.a=Math.round((o&255)/.255)/1e3):(a.r=o>>16,a.g=o>>8&255,a.b=o&255,a.a=-1)}return a};const ie={class:"w-full h-full rounded-lg shadow-lg bg-slate-600"},ce={props:{boundary:Object,election:Object,displayType:Object,tagProperty:String,focusPath:Object},emits:["changeFocus"],setup(o,{emit:e}){const r=o,a=600,n=700,l=Z();var u,f,d=null,m=!1;function y(t){if(t==null)return"#616161";for(let c of W.parties)if(c.name==t||c.fullname==t||c.abbr.includes(t)||c.abbr.includes(t.toLowerCase()))return c.colour;return"#616161"}function v(t){if(console.log("boundary",t),t==null||t=={}||t.features==null||t.features.length==0)return;let c=ee().projection(te().fitExtent([[0,0],[n,a]],t));u.attr("viewBox",[[0,0],[n,a]]),u.call(l.on("zoom",s=>{f.attr("transform",s.transform)}).scaleExtent([1,8]).translateExtent([[0,0],[n,a]])),f.attr("transform","translate(0 0) scale(1)"),f.selectAll("path").data(t.features).enter().append("path").attr("d",c).attr("data-tag",s=>s.properties[r.tagProperty]).attr("fill","red").on("mouseover",s=>{m||e("changeFocus",s.target.getAttribute("data-tag"))}).on("click",s=>{if(d&&d.getAttribute("data-tag")==s.target.getAttribute("data-tag"))return g();e("changeFocus",s.target.getAttribute("data-tag")),$(s.target)})}function g(){d.setAttribute("stroke",""),u.transition().duration(500).call(l.transform,J),m=!1,d=null}function $(t){let c=t.getBBox(),[s,_]=[c.x+c.width/2,c.y+c.height/2];d&&d.setAttribute("stroke",""),u.transition().duration(500).call(l.transform,J.translate(n/2,a/2).scale(8).translate(-s,-_)),t.setAttribute("stroke","gold"),t.setAttribute("stroke-width","0.05%"),t.setAttribute("stroke-linejoin","round"),Y(t).raise(),m=!0,d=t}function F(t,c){f.selectAll("path").attr("fill",s=>{let _;switch(r.displayType.filter){case"majority":_=D;break;case"plurality":_=U;break;default:_=R}if(!_(t,s))return"#616161";switch(r.displayType.fill){case"majority":return w(t,s);case"second":return T(t,s);case"turnout":return N(t,s);default:return E(t,s)}})}function D(t,c){let s=t[c.properties[r.tagProperty]];return!s||!s.candidates[0]||s.turnout<=0?!1:s.candidates[0].votes/s.turnout>.5}function U(t,c){return!D(t,c)}function R(){return!0}function E(t,c){var _;let s=((_=t[c.properties[r.tagProperty]])==null?void 0:_.mp.party)||void 0;return y(s)}function T(t,c){var _,L;let s=((L=(_=t[c.properties[r.tagProperty]])==null?void 0:_.candidates[1])==null?void 0:L.party)||void 0;return y(s)}function N(t,c){let s=.5,_=t[c.properties[r.tagProperty]];return _?O((1-s-_.turnout/_.electorate)*1.5,"#aed581",!1,!0):"#616161"}function w(t,c){var L;let s=t[c.properties[r.tagProperty]];if(!s)return"#616161";let _=((L=t[c.properties[r.tagProperty]])==null?void 0:L.mp.party)||void 0;return O(1-s.majority/s.candidates[0].votes-.25,y(_),!1,!0)}return q(async()=>{u=Y("div svg").attr("viewBox",[[0,0],[n,a]]),f=u.append("g"),X(()=>{v(r.boundary.value)}),X(()=>{console.log("recolouring map"),F(r.election.value)}),H(r.focusPath,()=>{if(r.focusPath.focusOn==null||r.focusPath.focusOn=="")return;let t=document.querySelectorAll(`path[data-tag='${r.focusPath.focusOn}']`);if(t.length==0||!t[0]){let c=Object.values(r.election.value).filter(s=>s.name.toLowerCase()==r.focusPath.focusOn.toLowerCase());if(!c||c.length==0||!c[0])return;t=document.querySelectorAll(`path[data-tag='${c[0].id}']`)}return e("changeFocus",t[0].getAttribute("data-tag")),$(t[0])})}),(t,c)=>(p(),h("div",ie,[(p(),h("svg",{ref_key:"map",ref:u,class:"w-full h-full rounded-lg"},null,512))]))}},ue={props:{width:String,colour:String},setup(o){const e=o;return(r,a)=>(p(),h("div",{style:V("width: "+e.width+"; background-color: "+e.colour),class:"h-5 my-1 transition-all duration-500 ease-in float-left relative"},null,4))}},de={class:"flex items-center rounded-xl bg-slate-800 bg-opacity-50 my-2 px-2 py-1"},fe={class:"basis-2/6"},pe=P(") "),me={class:"basis-2/6"},he={class:"basis-2/6"},be={class:"float-right"},ye={props:{candidate:Object,totalVotes:Number},setup(o){const e=o;function r(a){for(let n of W.parties)if(n.name==a||n.fullname==a||n.abbr.includes(a)||n.abbr.includes(a.toLowerCase()))return n.colour;return"#DDDDDD"}return(a,n)=>(p(),h("div",de,[i("span",fe,[P(b(e.candidate.candidate)+" (",1),i("span",{class:"font-bold",style:V("color: "+r(e.candidate.party))},b(e.candidate.party),5),pe]),i("span",me,b(e.candidate.votes)+" ("+b(Math.floor(e.candidate.votes/e.totalVotes*100*100)/100)+"%) ",1),i("div",he,[B(ue,{width:`${100*e.candidate.votes/e.totalVotes}%`,colour:r(e.candidate.party)},null,8,["width","colour"]),i("span",be,b(e.candidate.change),1)])]))}},ge={class:"w-full bg-slate-600 rounded-lg shadow-lg p-4 text-gray-100"},_e={key:0,class:"block font-bold text-2xl"},ve={key:1,class:"inline-block font-bold text-3xl"},Pe={key:2,class:"inline-block font-thin text-sm pl-2"},xe={key:3,class:"block font-bold text-xl"},we=P(" By-Election: "),Se={class:"font-normal"},ke=i("br",null,null,-1),Ce=P(" Date: "),De={class:"font-normal"},Ee=i("br",null,null,-1),je=P(" Reason: "),Fe={class:"font-normal"},Le={key:4,class:"block font-bold text-xl"},Be=P(") "),Ae={key:5,class:"font-bold text-lg inline-block"},Oe=P(" Result: "),$e={class:"font-normal"},Ue=P(" majority of "),Ne={class:"font-normal"},Me={key:6,class:"font-bold text-lg block"},Re=P(" Electorate: "),Te={class:"font-normal"},Ve=P(" turnout of "),Ge={class:"font-normal"},Ie={key:7},Ke={key:0},ze={props:{result:Object},setup(o){const e=o;function r(n){let l=5,u=0,f=[],d=[],m=0;for(let y of n)u<l||u==l&&u==n.length-1?(y.order=u,f.push(y)):(m+=y.votes,d.push(y.party)),u++;return m!=0&&f.push({candidate:"Other",party:"Various",votes:m}),[f,d]}function a(n){for(let l of W.parties)if(l.name==n||l.fullname==n||l.abbr.includes(n)||l.abbr.includes(n.toLowerCase()))return l.colour;return"#DDDDDD"}return(n,l)=>(p(),h("div",ge,[e.result.name?S("",!0):(p(),h("h1",_e,"Select or Mouseover A Constituency To Begin")),e.result.name?(p(),h("h1",ve,b(e.result.name||""),1)):S("",!0),e.result.id?(p(),h("h5",Pe,"("+b(e.result.id||"")+")",1)):S("",!0),e.result["by-election"]?(p(),h("h3",xe,[we,i("span",Se,b(e.result["by-election"].previous),1),ke,Ce,i("span",De,b(e.result["by-election"].date),1),Ee,je,i("span",Fe,b(e.result["by-election"].reason),1)])):S("",!0),e.result.mp?(p(),h("h3",Le,[P(" Elected MP: "+b(e.result.mp.name||"N/A")+" (",1),i("span",{style:V("color: "+a(e.result.mp.party))},b(e.result.mp.party||"Ind"),5),Be])):S("",!0),e.result.result&&e.result.majority&&e.result.electorate?(p(),h("h3",Ae,[Oe,i("span",$e,b(e.result.result),1),Ue,i("span",Ne,b(e.result.majority)+" ("+b(Math.floor(e.result.majority/e.result.electorate*100*100)/100)+"%)",1)])):S("",!0),e.result.electorate&&e.result.turnout?(p(),h("h3",Me,[Re,i("span",Te,b(e.result.electorate),1),Ve,i("span",Ge,b(e.result.turnout)+" ("+b(Math.floor(e.result.turnout/e.result.electorate*100*100)/100)+"%)",1)])):S("",!0),e.result.candidates?(p(),h("div",Ie,[(p(!0),h(j,null,A(r(e.result.candidates)[0],u=>(p(),ne(ye,{key:u.order,candidate:u,totalVotes:e.result.turnout},null,8,["candidate","totalVotes"]))),128)),r(e.result.candidates)[1].length>0?(p(),h("span",Ke," Others: "+b(r(e.result.candidates)[1].join(", "))+". ",1)):S("",!0)])):S("",!0)]))}};var We=(o,e)=>{const r=o.__vccOpts||o;for(const[a,n]of e)r[a]=n;return r};const qe={},Ye={href:"https://github.com/jamesm2w",class:"",target:"_blank"},Xe=i("div",{class:"m-4 mb-0 p-2 text-gradient text-transparent bg-clip-text w-min pointer-events-none select-none"},[i("h3",{class:"font-mono font-bold text-3xl"},"jamesm2w/"),i("h1",{class:"font-mono font-semibold text-5xl"},[P(" Election "),i("br"),P("Results ")])],-1),He=[Xe];function Je(o,e){return p(),h("a",Ye,He)}var Qe=We(qe,[["render",Je]]);const Ze={id:"selectionList"},et=["value"],tt={props:{election:Object},setup(o){const e=o;return H(e.election,()=>{console.log("election",e.election.value)}),(r,a)=>(p(),h("datalist",Ze,[(p(!0),h(j,null,A(Object.keys(e.election.value),n=>(p(),h("option",{key:n,value:e.election.value[n].id},b(e.election.value[n].name),9,et))),128))]))}},nt={class:"flex justify-between items-center flex-wrap"},ot={class:"mr-4 my-2 bg-slate-400 p-4 rounded-md shadow-md flex flex-wrap items-center justify-between space-x-2 w-3/5 gap-2 flex-1"},rt={class:"basis-full"},at=i("label",{for:"selectPath"},"Search: ",-1),lt={class:"flex-1"},st=i("label",{for:"selectElectionCode"},"Election: ",-1),it={class:"flex-1"},ct=i("label",{for:"selectMapShading"},"Display: ",-1),ut=["value"],dt={class:"flex-1"},ft=i("label",{for:"selectMapFilter"},"Filter: ",-1),pt=["value"],mt=re('<div class="w-full bg-slate-600 rounded-lg shadow-lg p-4 text-gray-100" style="grid-column:1/-1;"> Wesbite licensed under the <a class="underline hover:no-underline text-red-500 hover:text-red-200 transition-all ease-in" href="https://raw.githubusercontent.com/jamesm2w/election-results/main/LICENSE">GNU AGPLv3</a>. (<a class="underline hover:no-underline text-blue-500 hover:text-blue-200 transition-all ease-in" href="https://github.com/jamesm2w/election-results">Github Source</a>). <br> Election Result information licensed under the <a class="underline hover:no-underline text-red-500 hover:text-red-200 transition-all ease-in" href="https://www.parliament.uk/site-information/copyright-parliament/open-parliament-licence/">Open Parliament Licence v3.0</a> (<a class="underline hover:no-underline text-blue-500 hover:text-blue-200 transition-all ease-in" href="https://electionresults.parliament.uk/">Results Source</a>). <br> UK Constituency Boundaries Source: Office for National Statistics licensed under the <a class="underline hover:no-underline text-red-500 hover:text-red-200 transition-all ease-in" href="https://www.ons.gov.uk/methodology/geography/licences">Open Government Licence v.3.0</a> (<a class="underline hover:no-underline text-blue-500 hover:text-blue-200 transition-all ease-in" href="https://geoportal.statistics.gov.uk/datasets/westminster-parliamentary-constituencies-december-2020-uk-bgc/explore?location=55.340085%2C-3.316534%2C6.04">Boundary Source</a>). </div>',1),ht={setup(o){let e=k({value:{}}),r=k({value:{}}),a=k({value:{}}),n=k({value:{}}),l=k({value:{}}),u=k({value:{}}),f=k({value:{}}),d=G({focusOn:""}),m=G({focusOn:""}),y=I("GE2019"),v=I("winner"),g=I("all"),$=G({fill:v,filter:g});const F={Default:"winner","Runner-Up":"second","Majority Shaded":"majority","Turnout Shaded":"turnout"},D={All:"all","Won on Majority":"majority","Won on Plurality":"plurality"},U={"BYE 2019-202X":{election:a,boundary:e},GE2019:{election:r,boundary:e},"BYE 2017-2015":{election:u,boundary:e},GE2017:{election:n,boundary:e},"BYE 2015-2017":{election:f,boundary:e},GE2015:{election:l,boundary:e}};function R(N){d.focusOn=N}q(async()=>{e.value=await C("./WestminsterConst.geojson"),r.value=await C("./2019.json"),n.value=await C("./2017.json"),l.value=await C("./2015.json"),a.value=await C("./2019-_ByElections.json"),u.value=await C("./2017-2019_ByElections.json"),f.value=await C("./2015-2017_ByElections.json")});const E=Q(()=>U[y.value]),T=Q(()=>E.value.election.value[d.focusOn]||{});return(N,w)=>(p(),h(j,null,[i("div",null,[i("div",nt,[B(Qe),i("div",ot,[B(tt,{election:x(E).election},null,8,["election"]),i("div",rt,[at,M(i("input",{name:"selectPath",class:"rounded-sm p-1","onUpdate:modelValue":w[0]||(w[0]=t=>x(m).focusOn=t),placeholder:"Start Typing",list:"selectionList"},null,512),[[oe,x(m).focusOn]])]),i("div",lt,[st,M(i("select",{name:"selectElectionCode",class:"cursor-pointer w-full rounded-sm p-1","onUpdate:modelValue":w[1]||(w[1]=t=>z(y)?y.value=t:y=t)},[(p(!0),h(j,null,A(Object.keys(U),t=>(p(),h("option",{key:t},b(t),1))),128))],512),[[K,x(y)]])]),i("div",it,[ct,M(i("select",{name:"selectMapShading",class:"cursor-pointer w-full rounded-sm p-1","onUpdate:modelValue":w[2]||(w[2]=t=>z(v)?v.value=t:v=t),value:"winner"},[(p(!0),h(j,null,A(Object.keys(F),t=>(p(),h("option",{key:F[t],value:F[t]},b(t),9,ut))),128))],512),[[K,x(v)]])]),i("div",dt,[ft,M(i("select",{name:"selectMapFilter",class:"cursor-pointer w-full rounded-sm p-1","onUpdate:modelValue":w[3]||(w[3]=t=>z(g)?g.value=t:g=t),value:"all"},[(p(!0),h(j,null,A(Object.keys(D),t=>(p(),h("option",{key:D[t],value:D[t]},b(t),9,pt))),128))],512),[[K,x(g)]])])])]),B(ze,{result:x(T)},null,8,["result"])]),B(ce,{boundary:x(E).boundary,election:x(E).election,tagProperty:"PCON20CD",displayType:x($),focusPath:x(m),onChangeFocus:R},null,8,["boundary","election","displayType","focusPath"]),mt],64))}};ae(ht).mount("#app");
