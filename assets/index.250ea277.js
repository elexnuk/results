import{z as Z,o as q,s as Y,w as X,a as H,b as p,c as b,i as ee,m as te,d as J,n as V,e as i,f as P,t as h,g as B,h as D,F as j,r as L,j as oe,k as S,l as G,p as I,q as C,u as Q,v as w,x as N,y as ne,A as K,B as z,C as re}from"./vendor.1aec0ec8.js";const ae=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function r(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerpolicy&&(l.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?l.credentials="include":o.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(o){if(o.ep)return;o.ep=!0;const l=r(o);fetch(o.href,l)}};ae();const le=[{name:"Speaker",colour:"#DDDDDD",abbr:["Spk","SPK","Speaker Seeking Re-Election"],fullname:"Speaker"},{name:"Respect Party",colour:"#46801C",abbr:["Respect","RESPECT"],fullname:"Respect Party"},{name:"Democratic Unionist Party",colour:"#D46A4C",abbr:["DUP","dup"],fullname:"Democratic Unionist Party"},{name:"Christian Peoples Alliance",colour:"#813887",abbr:["CPA","cpa"],fullname:"Christian Peoples Alliance"},{name:"National Front",colour:"midnightblue",abbr:["NF","nf"],fullname:"National Front"},{name:"Sinn Fein",colour:"#326760",abbr:["SF","sf"],fullname:"Sinn Fein"},{name:"Ulster Conservatives and Unionists - New Force",colour:"#9999FF",abbr:["UCF-NF"],fullname:"Ulster Conservatives and Unionists - New Force"},{name:"Alliance",colour:"#F6CB2F",abbr:["All","ALL"],fullname:"Alliance"},{name:"Social Democratic & Labour Party",colour:"#3A9E84",abbr:["SDLP"],fullname:"Social Democratic & Labour Party"},{name:"Soc Lab",colour:"#EE1C25",abbr:["Soc Lab"],fullname:"Socialist Labour"},{name:"Lab Co-op",colour:"#DC241f",abbr:["Lab Co-op"],fullname:"Labour Co-operative"},{name:"Monster Raving Loony Party",colour:"#FFF000",abbr:["MRLP"],fullname:"Official Monster Raving Loony Party"},{name:"Trade Unionist and Socialist Coalition",colour:"#EC008C",abbr:["TUSC"],fullname:"Trade Unionist and Socialist Coalition"},{name:"Plaid Cymru",colour:"#008142",abbr:["PC"],fullname:"Plaid Cymru"},{name:"Scottish National Party",colour:"#FDF38E",abbr:["SNP"],fullname:"Scottish National Party"},{name:"Christian Party",colour:"#9966CC",abbr:"Christian",fullname:"Christian Party"},{name:"English Democrats",colour:"#915F6D",abbr:["ED"],fullname:"English Democrats"},{name:"Independent",colour:"#DDDDDD",abbr:["Ind","No Description"],fullname:"Independent"},{name:"Green Party",colour:"#6AB023",abbr:["Green"],fullname:"Green Party"},{name:"British National Party",colour:"#2e3b74",abbr:["BNP"],fullname:"British National Party"},{name:"United Kingdom Independence Party",colour:"#70147A",abbr:["UKIP"],fullname:"UK Independence Party"},{name:"Labour Party",colour:"#DC241f",abbr:["Lab"],fullname:"Labour"},{name:"Conservative Party",colour:"#0087DC",abbr:["Con"],fullname:"Conservative"},{name:"Liberal Democrat",colour:"#FAA61A",abbr:["LD"],fullname:"Liberal Democrat"},{name:"Ulster Unionist Party",colour:"#48A5EE",abbr:["UUP"],fullname:"Ulster Unionist Party"},{name:"Brexit Party",colour:"#12B6CF",abbr:["Brexit","RefUK"],fullname:"Reform UK"}];var W={parties:le};const O=(n,e,r,a)=>{let o,l,u,f,d,m,y,v=Math.round,_=typeof r=="string";return typeof n!="number"||n<-1||n>1||typeof e!="string"||e[0]!="r"&&e[0]!="#"||r&&!_||(y=e.length>9,y=_?r.length>9?!0:r=="c"?!y:!1:y,d=O.pSBCr(e),f=n<0,m=r&&r!="c"?O.pSBCr(r):f?{r:0,g:0,b:0,a:-1}:{r:255,g:255,b:255,a:-1},n=f?n*-1:n,f=1-n,!d||!m)?null:(a?(o=v(f*d.r+n*m.r),l=v(f*d.g+n*m.g),u=v(f*d.b+n*m.b)):(o=v((f*d.r**2+n*m.r**2)**.5),l=v((f*d.g**2+n*m.g**2)**.5),u=v((f*d.b**2+n*m.b**2)**.5)),_=d.a,m=m.a,d=_>=0||m>=0,_=d?_<0?m:m<0?_:_*f+m*n:0,y?"rgb"+(d?"a(":"(")+o+","+l+","+u+(d?","+v(_*1e3)/1e3:"")+")":"#"+(4294967296+o*16777216+l*65536+u*256+(d?v(_*255):0)).toString(16).slice(1,d?void 0:-2))};O.pSBCr=n=>{const e=parseInt;let r=n.length,a={};if(r>9){const[o,l,u,f]=n=n.split(",");if(r=n.length,r<3||r>4)return null;a.r=e(o[3]=="a"?o.slice(5):o.slice(4)),a.g=e(l),a.b=e(u),a.a=f?parseFloat(f):-1}else{if(r==8||r==6||r<4)return null;r<6&&(n="#"+n[1]+n[1]+n[2]+n[2]+n[3]+n[3]+(r>4?n[4]+n[4]:"")),n=e(n.slice(1),16),r==9||r==5?(a.r=n>>24&255,a.g=n>>16&255,a.b=n>>8&255,a.a=Math.round((n&255)/.255)/1e3):(a.r=n>>16,a.g=n>>8&255,a.b=n&255,a.a=-1)}return a};const se={class:"w-full h-full rounded-lg shadow-lg bg-slate-600"},ie={props:{boundary:Object,election:Object,displayType:Object,tagProperty:String,focusPath:Object},emits:["changeFocus"],setup(n,{emit:e}){const r=n,a=600,o=700,l=Z();var u,f,d=null,m=!1;function y(t){if(t==null)return"#616161";for(let c of W.parties)if(c.name==t||c.fullname==t||c.abbr.includes(t)||c.abbr.includes(t.toLowerCase()))return c.colour;return"#616161"}function v(t){if(console.log("boundary",t),t==null||t=={}||t.features==null||t.features.length==0)return;let c=ee().projection(te().fitExtent([[0,0],[o,a]],t));u.attr("viewBox",[[0,0],[o,a]]),u.call(l.on("zoom",s=>{f.attr("transform",s.transform)}).scaleExtent([1,8]).translateExtent([[0,0],[o,a]])),f.attr("transform","translate(0 0) scale(1)"),f.selectAll("path").data(t.features).enter().append("path").attr("d",c).attr("data-tag",s=>s.properties[r.tagProperty]).attr("fill","red").on("mouseover",s=>{m||e("changeFocus",s.target.getAttribute("data-tag"))}).on("click",s=>{if(d&&d.getAttribute("data-tag")==s.target.getAttribute("data-tag"))return _();e("changeFocus",s.target.getAttribute("data-tag")),$(s.target)})}function _(){d.setAttribute("stroke",""),u.transition().duration(500).call(l.transform,J),m=!1,d=null}function $(t){let c=t.getBBox(),[s,g]=[c.x+c.width/2,c.y+c.height/2];d&&d.setAttribute("stroke",""),u.transition().duration(500).call(l.transform,J.translate(o/2,a/2).scale(8).translate(-s,-g)),t.setAttribute("stroke","gold"),t.setAttribute("stroke-width","0.05%"),t.setAttribute("stroke-linejoin","round"),Y(t).raise(),m=!0,d=t}function F(t,c){f.selectAll("path").attr("fill",s=>{let g;switch(r.displayType.filter){case"majority":g=k;break;case"plurality":g=U;break;default:g=T}if(!g(t,s))return"#616161";switch(r.displayType.fill){case"majority":return x(t,s);case"second":return R(t,s);case"turnout":return M(t,s);default:return E(t,s)}})}function k(t,c){let s=t[c.properties[r.tagProperty]];return!s||!s.candidates[0]||s.turnout<=0?!1:s.candidates[0].votes/s.turnout>.5}function U(t,c){return!k(t,c)}function T(){return!0}function E(t,c){var g;let s=((g=t[c.properties[r.tagProperty]])==null?void 0:g.mp.party)||void 0;return y(s)}function R(t,c){var g,A;let s=((A=(g=t[c.properties[r.tagProperty]])==null?void 0:g.candidates[1])==null?void 0:A.party)||void 0;return y(s)}function M(t,c){let s=.5,g=t[c.properties[r.tagProperty]];return g?O((1-s-g.turnout/g.electorate)*1.5,"#aed581",!1,!0):"#616161"}function x(t,c){var A;let s=t[c.properties[r.tagProperty]];if(!s)return"#616161";let g=((A=t[c.properties[r.tagProperty]])==null?void 0:A.mp.party)||void 0;return O(1-s.majority/s.candidates[0].votes-.25,y(g),!1,!0)}return q(async()=>{u=Y("div svg").attr("viewBox",[[0,0],[o,a]]),f=u.append("g"),X(()=>{v(r.boundary.value)}),X(()=>{console.log("recolouring map"),F(r.election.value)}),H(r.focusPath,()=>{if(r.focusPath.focusOn==null||r.focusPath.focusOn=="")return;let t=document.querySelectorAll(`path[data-tag='${r.focusPath.focusOn}']`);if(t.length==0||!t[0]){let c=Object.values(r.election.value).filter(s=>s.name.toLowerCase()==r.focusPath.focusOn.toLowerCase());if(!c||c.length==0||!c[0])return;t=document.querySelectorAll(`path[data-tag='${c[0].id}']`)}return e("changeFocus",t[0].getAttribute("data-tag")),$(t[0])})}),(t,c)=>(p(),b("div",se,[(p(),b("svg",{ref_key:"map",ref:u,class:"rounded-lg"},null,512))]))}},ce={props:{width:String,colour:String},setup(n){const e=n;return(r,a)=>(p(),b("div",{style:V("width: "+e.width+"; background-color: "+e.colour),class:"h-5 my-1 transition-all duration-500 ease-in float-left relative"},null,4))}},ue={class:"flex items-center rounded-xl bg-slate-800 bg-opacity-50 my-2 px-2 py-1"},de={class:"basis-2/6"},fe=P(") "),pe={class:"basis-2/6"},me={class:"basis-2/6"},be={class:"float-right"},he={props:{candidate:Object,totalVotes:Number},setup(n){const e=n;function r(a){for(let o of W.parties)if(o.name==a||o.fullname==a||o.abbr.includes(a)||o.abbr.includes(a.toLowerCase()))return o.colour;return"#DDDDDD"}return(a,o)=>(p(),b("div",ue,[i("span",de,[P(h(e.candidate.candidate)+" (",1),i("span",{class:"font-bold",style:V("color: "+r(e.candidate.party))},h(e.candidate.party),5),fe]),i("span",pe,h(e.candidate.votes)+" ("+h(Math.floor(e.candidate.votes/e.totalVotes*100*100)/100)+"%) ",1),i("div",me,[B(ce,{width:`${100*e.candidate.votes/e.totalVotes}%`,colour:r(e.candidate.party)},null,8,["width","colour"]),i("span",be,h(e.candidate.change),1)])]))}},ye={class:"w-full bg-slate-600 rounded-lg shadow-lg p-4 text-gray-100"},_e={key:0,class:"block font-bold text-2xl"},ge={key:1,class:"inline-block font-bold text-3xl"},ve={key:2,class:"inline-block font-thin text-sm pl-2"},Pe={key:3,class:"block font-bold text-xl"},we=P(" By-Election: "),xe={class:"font-normal"},De=i("br",null,null,-1),Se=P(" Date: "),Ce={class:"font-normal"},ke=i("br",null,null,-1),Ee=P(" Reason: "),je={class:"font-normal"},Fe={key:4,class:"block font-bold text-xl"},Ae=P(") "),Be={key:5,class:"font-bold text-lg inline-block"},Le=P(" Result: "),Oe={class:"font-normal"},$e=P(" majority of "),Ue={class:"font-normal"},Me={key:6,class:"font-bold text-lg block"},Ne=P(" Electorate: "),Te={class:"font-normal"},Re=P(" turnout of "),Ve={class:"font-normal"},Ge={key:7},Ie={key:0},Ke={props:{result:Object},setup(n){const e=n;function r(o){let l=5,u=0,f=[],d=[],m=0;for(let y of o)u<l||u==l&&u==o.length-1?(y.order=u,f.push(y)):(m+=y.votes,d.push(y.party)),u++;return m!=0&&f.push({candidate:"Other",party:"Various",votes:m}),[f,d]}function a(o){for(let l of W.parties)if(l.name==o||l.fullname==o||l.abbr.includes(o)||l.abbr.includes(o.toLowerCase()))return l.colour;return"#DDDDDD"}return(o,l)=>(p(),b("div",ye,[e.result.name?D("",!0):(p(),b("h1",_e,"Select or Mouseover A Constituency To Begin")),e.result.name?(p(),b("h1",ge,h(e.result.name||""),1)):D("",!0),e.result.id?(p(),b("h5",ve,"("+h(e.result.id||"")+")",1)):D("",!0),e.result["by-election"]?(p(),b("h3",Pe,[we,i("span",xe,h(e.result["by-election"].previous),1),De,Se,i("span",Ce,h(e.result["by-election"].date),1),ke,Ee,i("span",je,h(e.result["by-election"].reason),1)])):D("",!0),e.result.mp?(p(),b("h3",Fe,[P(" Elected MP: "+h(e.result.mp.name||"N/A")+" (",1),i("span",{style:V("color: "+a(e.result.mp.party))},h(e.result.mp.party||"Ind"),5),Ae])):D("",!0),e.result.result&&e.result.majority&&e.result.electorate?(p(),b("h3",Be,[Le,i("span",Oe,h(e.result.result),1),$e,i("span",Ue,h(e.result.majority)+" ("+h(Math.floor(e.result.majority/e.result.electorate*100*100)/100)+"%)",1)])):D("",!0),e.result.electorate&&e.result.turnout?(p(),b("h3",Me,[Ne,i("span",Te,h(e.result.electorate),1),Re,i("span",Ve,h(e.result.turnout)+" ("+h(Math.floor(e.result.turnout/e.result.electorate*100*100)/100)+"%)",1)])):D("",!0),e.result.candidates?(p(),b("div",Ge,[(p(!0),b(j,null,L(r(e.result.candidates)[0],u=>(p(),oe(he,{key:u.order,candidate:u,totalVotes:e.result.turnout},null,8,["candidate","totalVotes"]))),128)),r(e.result.candidates)[1].length>0?(p(),b("span",Ie," Others: "+h(r(e.result.candidates)[1].join(", "))+". ",1)):D("",!0)])):D("",!0)]))}};var ze=(n,e)=>{const r=n.__vccOpts||n;for(const[a,o]of e)r[a]=o;return r};const We={},qe={href:"https://github.com/jamesm2w",class:"",target:"_blank"},Ye=i("div",{class:"m-4 mb-0 p-2 text-gradient text-transparent bg-clip-text w-min pointer-events-none select-none"},[i("h3",{class:"font-mono font-bold text-3xl"},"jamesm2w/"),i("h1",{class:"font-mono font-semibold text-5xl"},[P(" Election "),i("br"),P("Results ")])],-1),Xe=[Ye];function He(n,e){return p(),b("a",qe,Xe)}var Je=ze(We,[["render",He]]);const Qe={id:"selectionList"},Ze=["value"],et={props:{election:Object},setup(n){const e=n;return H(e.election,()=>{console.log("election",e.election.value)}),(r,a)=>(p(),b("datalist",Qe,[(p(!0),b(j,null,L(Object.keys(e.election.value),o=>(p(),b("option",{key:o,value:e.election.value[o].id},h(e.election.value[o].name),9,Ze))),128))]))}},tt={class:"flex justify-between items-center flex-wrap"},ot={class:"mr-4 my-2 bg-slate-400 p-4 rounded-md shadow-md flex flex-wrap items-center justify-between space-x-2 w-3/5 gap-2"},nt={class:"basis-full"},rt=i("label",{for:"selectPath"},"Search: ",-1),at={class:"flex-1"},lt=i("label",{for:"selectElectionCode"},"Election: ",-1),st={class:"flex-1"},it=i("label",{for:"selectMapShading"},"Display: ",-1),ct=["value"],ut={class:"flex-1"},dt=i("label",{for:"selectMapFilter"},"Filter: ",-1),ft=["value"],pt={setup(n){let e=S({value:{}}),r=S({value:{}}),a=S({value:{}}),o=S({value:{}}),l=S({value:{}}),u=S({value:{}}),f=S({value:{}}),d=G({focusOn:""}),m=G({focusOn:""}),y=I("GE2019"),v=I("winner"),_=I("all"),$=G({fill:v,filter:_});const F={Default:"winner","Runner-Up":"second","Majority Shaded":"majority","Turnout Shaded":"turnout"},k={All:"all","Won on Majority":"majority","Won on Plurality":"plurality"},U={"BYE 2019-202X":{election:a,boundary:e},GE2019:{election:r,boundary:e},"BYE 2017-2015":{election:u,boundary:e},GE2017:{election:o,boundary:e},"BYE 2015-2017":{election:f,boundary:e},GE2015:{election:l,boundary:e}};function T(M){d.focusOn=M}q(async()=>{e.value=await C("./WestminsterConst.geojson"),r.value=await C("./2019.json"),o.value=await C("./2017.json"),l.value=await C("./2015.json"),a.value=await C("./2019-_ByElections.json"),u.value=await C("./2017-2019_ByElections.json"),f.value=await C("./2015-2017_ByElections.json")});const E=Q(()=>U[y.value]),R=Q(()=>E.value.election.value[d.focusOn]||{});return(M,x)=>(p(),b(j,null,[i("div",null,[i("div",tt,[B(Je),i("div",ot,[B(et,{election:w(E).election},null,8,["election"]),i("div",nt,[rt,N(i("input",{name:"selectPath",class:"rounded-sm p-1","onUpdate:modelValue":x[0]||(x[0]=t=>w(m).focusOn=t),placeholder:"Start Typing",list:"selectionList"},null,512),[[ne,w(m).focusOn]])]),i("div",at,[lt,N(i("select",{name:"selectElectionCode",class:"cursor-pointer w-full rounded-sm p-1","onUpdate:modelValue":x[1]||(x[1]=t=>z(y)?y.value=t:y=t)},[(p(!0),b(j,null,L(Object.keys(U),t=>(p(),b("option",{key:t},h(t),1))),128))],512),[[K,w(y)]])]),i("div",st,[it,N(i("select",{name:"selectMapShading",class:"cursor-pointer w-full rounded-sm p-1","onUpdate:modelValue":x[2]||(x[2]=t=>z(v)?v.value=t:v=t),value:"winner"},[(p(!0),b(j,null,L(Object.keys(F),t=>(p(),b("option",{key:F[t],value:F[t]},h(t),9,ct))),128))],512),[[K,w(v)]])]),i("div",ut,[dt,N(i("select",{name:"selectMapFilter",class:"cursor-pointer w-full rounded-sm p-1","onUpdate:modelValue":x[3]||(x[3]=t=>z(_)?_.value=t:_=t),value:"all"},[(p(!0),b(j,null,L(Object.keys(k),t=>(p(),b("option",{key:k[t],value:k[t]},h(t),9,ft))),128))],512),[[K,w(_)]])])])]),B(Ke,{result:w(R)},null,8,["result"])]),B(ie,{boundary:w(E).boundary,election:w(E).election,tagProperty:"PCON20CD",displayType:w($),focusPath:w(m),onChangeFocus:T},null,8,["boundary","election","displayType","focusPath"])],64))}};re(pt).mount("#app");
