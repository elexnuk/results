import{z as j,w as k,o as L,s as O,a as s,c,i as R,m as M,b as w,n as D,d,e as p,t as i,f as P,g as _,F,r as V,h as T,j as A,k as I,l as E,p as N,u as U,q as K}from"./vendor.ef10ad53.js";const z=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function o(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerpolicy&&(a.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?a.credentials="include":t.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(t){if(t.ep)return;t.ep=!0;const a=o(t);fetch(t.href,a)}};z();const G=[{name:"Speaker",colour:"#DDDDDD",abbr:["Spk","SPK","Speaker Seeking Re-Election"],fullname:"Speaker"},{name:"Respect Party",colour:"#46801C",abbr:["Respect","RESPECT"],fullname:"Respect Party"},{name:"Democratic Unionist Party",colour:"#D46A4C",abbr:["DUP","dup"],fullname:"Democratic Unionist Party"},{name:"Christian Peoples Alliance",colour:"#813887",abbr:["CPA","cpa"],fullname:"Christian Peoples Alliance"},{name:"National Front",colour:"midnightblue",abbr:["NF","nf"],fullname:"National Front"},{name:"Sinn Fein",colour:"#326760",abbr:["SF","sf"],fullname:"Sinn Fein"},{name:"Ulster Conservatives and Unionists - New Force",colour:"#9999FF",abbr:["UCF-NF"],fullname:"Ulster Conservatives and Unionists - New Force"},{name:"Alliance",colour:"#F6CB2F",abbr:["All","ALL"],fullname:"Alliance"},{name:"Social Democratic & Labour Party",colour:"#3A9E84",abbr:["SDLP"],fullname:"Social Democratic & Labour Party"},{name:"Soc Lab",colour:"#EE1C25",abbr:["Soc Lab"],fullname:"Socialist Labour"},{name:"Lab Co-op",colour:"#DC241f",abbr:["Lab Co-op"],fullname:"Labour Co-operative"},{name:"Monster Raving Loony Party",colour:"#FFF000",abbr:["MRLP"],fullname:"Official Monster Raving Loony Party"},{name:"Trade Unionist and Socialist Coalition",colour:"#EC008C",abbr:["TUSC"],fullname:"Trade Unionist and Socialist Coalition"},{name:"Plaid Cymru",colour:"#008142",abbr:["PC"],fullname:"Plaid Cymru"},{name:"Scottish National Party",colour:"#FDF38E",abbr:["SNP"],fullname:"Scottish National Party"},{name:"Christian Party",colour:"#9966CC",abbr:"Christian",fullname:"Christian Party"},{name:"English Democrats",colour:"#915F6D",abbr:["ED"],fullname:"English Democrats"},{name:"Independent",colour:"#DDDDDD",abbr:["Ind","No Description"],fullname:"Independent"},{name:"Green Party",colour:"#6AB023",abbr:["Green"],fullname:"Green Party"},{name:"British National Party",colour:"#2e3b74",abbr:["BNP"],fullname:"British National Party"},{name:"United Kingdom Independence Party",colour:"#70147A",abbr:["UKIP"],fullname:"UK Independence Party"},{name:"Labour Party",colour:"#DC241f",abbr:["Lab"],fullname:"Labour"},{name:"Conservative Party",colour:"#0087DC",abbr:["Con"],fullname:"Conservative"},{name:"Liberal Democrat",colour:"#FAA61A",abbr:["LD"],fullname:"Liberal Democrat"},{name:"Ulster Unionist Party",colour:"#48A5EE",abbr:["UUP"],fullname:"Ulster Unionist Party"},{name:"Brexit Party",colour:"#12B6CF",abbr:["Brexit","RefUK"],fullname:"Reform UK"}];var S={parties:G};const q={class:"w-full h-full rounded-lg shadow-lg bg-slate-600"},W={props:{dataSource:Object,displayType:Object,tagProperty:String},emits:["changeFocus"],setup(f,{emit:e}){const o=f,r=600,t=700,a=j();var n,m,h=null,y=!1;function v(l){if(l==null)return"#616161";for(let b of S.parties)if(b.name==l||b.fullname==l||b.abbr.includes(l)||b.abbr.includes(l.toLowerCase()))return b.colour;return"#616161"}function x(){let l=o.dataSource.boundary.value;if(console.log("boundary",l),l==null||l=={}||l.features==null||l.features.length==0)return;let b=R().projection(M().fitExtent([[0,0],[t,r]],l));n.attr("viewBox",[[0,0],[t,r]]),n.call(a.on("zoom",u=>{m.attr("transform",u.transform)}).scaleExtent([1,8]).translateExtent([[0,0],[t,r]])),m.attr("transform","translate(0 0) scale(1)"),m.selectAll("path").data(l.features).enter().append("path").attr("d",b).attr("data-tag",u=>u.properties[o.tagProperty]).attr("fill","red").on("mouseover",u=>{y||e("changeFocus",u.target.getAttribute("data-tag"))}).on("click",u=>{let g=u.target.getBBox(),[$,B]=[g.x+g.width/2,g.y+g.height/2];if(h&&(h.setAttribute("stroke",""),h.getAttribute("data-tag")==u.target.getAttribute("data-tag"))){n.transition().duration(500).call(a.transform,w),y=!1,h=null;return}n.transition().duration(500).call(a.transform,w.translate(t/2,r/2).scale(8).translate(-$,-B)),u.target.setAttribute("stroke","gold"),u.target.setAttribute("stroke-width","0.05%"),y=!0,h=u.target,e("changeFocus",u.target.getAttribute("data-tag"))})}function C(){let l=o.dataSource.election.value;m.selectAll("path").attr("fill",b=>{var g;let u=((g=l[b.properties[o.tagProperty]])==null?void 0:g.mp.party)||void 0;return v(u)})}return k(o.dataSource.boundary,()=>{console.log("Src Boundaries changed ",o.dataSource.boundary.value),x()}),k(o.dataSource.election,()=>{console.log("Src Election changed ",o.dataSource.election.value),C()}),L(async()=>{console.log("Mounted with ",o.dataSource.boundary.value),n=O("div svg").attr("viewBox",[[0,0],[t,r]]),m=n.append("g"),x(),C()}),(l,b)=>(s(),c("div",q,[(s(),c("svg",{ref_key:"map",ref:n,class:"rounded-lg"},null,512))]))}},X={props:{width:String,colour:String},setup(f){const e=f;return(o,r)=>(s(),c("div",{style:D("width: "+e.width+"; background-color: "+e.colour),class:"h-5 my-1 transition-all duration-500 ease-in float-left relative"},null,4))}},Y={class:"flex items-center rounded-xl bg-slate-800 bg-opacity-50 my-2 px-2 py-1"},H={class:"basis-2/6"},J=p(") "),Q={class:"basis-2/6"},Z={class:"basis-2/6"},ee={class:"float-right"},te={props:{candidate:Object,totalVotes:Number},setup(f){const e=f;function o(r){for(let t of S.parties)if(t.name==r||t.fullname==r||t.abbr.includes(r)||t.abbr.includes(r.toLowerCase()))return t.colour;return"#DDDDDD"}return(r,t)=>(s(),c("div",Y,[d("span",H,[p(i(e.candidate.candidate)+" (",1),d("span",{class:"font-bold",style:D("color: "+o(e.candidate.party))},i(e.candidate.party),5),J]),d("span",Q,i(e.candidate.votes)+" ("+i(Math.floor(e.candidate.votes/e.totalVotes*100*100)/100)+"%) ",1),d("div",Z,[P(X,{width:`${100*e.candidate.votes/e.totalVotes}%`,colour:o(e.candidate.party)},null,8,["width","colour"]),d("span",ee,i(e.candidate.change),1)])]))}},ae={class:"w-full bg-slate-600 rounded-lg shadow-lg p-4 text-gray-100"},oe={key:0,class:"block font-bold text-2xl"},re={key:1,class:"inline-block font-bold text-3xl"},ne={key:2,class:"inline-block font-thin text-sm pl-2"},se={key:3,class:"block font-bold text-xl"},le=p(") "),ce={key:4,class:"font-bold text-lg inline-block"},ie=p(" Result: "),ue={class:"font-normal"},de=p(" majority of "),fe={class:"font-normal"},me={key:5,class:"font-bold text-lg block"},be=p(" Electorate: "),pe={class:"font-normal"},he=p(" turnout of "),_e={class:"font-normal"},ye={key:6},ge={key:0},ve={props:{result:Object},setup(f){const e=f;function o(t){let a=5,n=0,m=[],h=[],y=0;for(let v of t)n<a||n==a&&n==t.length-1?m.push(v):(y+=v.votes,h.push(v.party)),n++;return y!=0&&m.push({candidate:"Other",party:"Various",votes:y}),[m,h]}function r(t){for(let a of S.parties)if(a.name==t||a.fullname==t||a.abbr.includes(t)||a.abbr.includes(t.toLowerCase()))return a.colour;return"#DDDDDD"}return(t,a)=>(s(),c("div",ae,[e.result.name?_("",!0):(s(),c("h1",oe,"Select or Mouseover A Constituency To Begin")),e.result.name?(s(),c("h1",re,i(e.result.name||""),1)):_("",!0),e.result.id?(s(),c("h5",ne,"("+i(e.result.id||"")+")",1)):_("",!0),e.result.mp?(s(),c("h3",se,[p(" Elected MP: "+i(e.result.mp.name||"N/A")+" (",1),d("span",{style:D("color: "+r(e.result.mp.party))},i(e.result.mp.party||"Ind"),5),le])):_("",!0),e.result.result&&e.result.majority&&e.result.electorate?(s(),c("h3",ce,[ie,d("span",ue,i(e.result.result),1),de,d("span",fe,i(e.result.majority)+" ("+i(Math.floor(e.result.majority/e.result.electorate*100*100)/100)+"%)",1)])):_("",!0),e.result.electorate&&e.result.turnout?(s(),c("h3",me,[be,d("span",pe,i(e.result.electorate),1),he,d("span",_e,i(e.result.turnout)+" ("+i(Math.floor(e.result.turnout/e.result.electorate*100*100)/100)+"%)",1)])):_("",!0),e.result.candidates?(s(),c("div",ye,[(s(!0),c(F,null,V(o(e.result.candidates)[0],n=>(s(),T(te,{key:n.candidate,candidate:n,totalVotes:e.result.turnout},null,8,["candidate","totalVotes"]))),128)),o(e.result.candidates)[1].length>0?(s(),c("span",ge," Others: "+i(o(e.result.candidates)[1].join(", "))+". ",1)):_("",!0)])):_("",!0)]))}};var Pe=(f,e)=>{const o=f.__vccOpts||f;for(const[r,t]of e)o[r]=t;return o};const De={},Se={class:"m-4 mb-0 p-2 text-gradient text-transparent bg-clip-text w-min pointer-events-none select-none"},xe=d("h3",{class:"font-mono font-bold text-3xl"},"jamesm2w/",-1),Ce=d("h1",{class:"font-mono font-semibold text-5xl"},[p(" Election "),d("br"),p("Results ")],-1),ke=[xe,Ce];function Le(f,e){return s(),c("div",Se,ke)}var we=Pe(De,[["render",Le]]);const Fe={setup(f){let e=A({value:{}}),o=A({value:{}}),r=I({focusOn:""});function t(m){r.focusOn=m}L(async()=>{e.value=await E("./WestminsterConst.geojson"),o.value=await E("./2019-_ByElections.json")});const a=N(()=>({boundary:e,election:o})),n=N(()=>a.value.election.value[r.focusOn]||{});return(m,h)=>(s(),c(F,null,[d("div",null,[P(we),P(ve,{result:U(n)},null,8,["result"])]),P(W,{dataSource:U(a),tagProperty:"PCON20CD",displayType:"majority",onChangeFocus:t},null,8,["dataSource"])],64))}};K(Fe).mount("#app");
